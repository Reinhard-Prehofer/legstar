<?xml version="1.0" encoding="UTF-8"?>
<!-- =================================================================================
     This script generates the cultureinfo sample web service.
 -->

<project basedir="../../.." default="server" name="cultureinfo">

    <import file="deploy-targets.xml"/>

	<path id="jaxws.classpath">
        <pathelement location="C:\Program Files\Java\jdk1.5.0_11\lib\tools.jar"/>
        <fileset dir="${lib.home}">
            <include name="*.jar"/>
            <exclude name="j2ee.jar"/>
        </fileset>
    </path>

    <taskdef name="apt" classname="com.sun.tools.ws.ant.Apt">
        <classpath refid="jaxws.classpath"/>
    </taskdef>

    <target name="setup">
        <mkdir dir="${build.home}"/>
        <mkdir dir="${build.classes.home}"/>
        <mkdir dir="${build.war.home}"/>
    </target>

    <target name="build-server-java">
		<apt
		    fork="true"
		    verbose="${verbose}"
		    destdir="${build.classes.home}"
		    sourcedestdir="${basedir}/src/test/gen/java"
			sourcepath="${basedir}/src/test/java">
		    <classpath>
		        <path refid="jaxws.classpath"/>
		    </classpath>
		    <option key="r" value="${build.home}"/>
		    <source dir="${basedir}/src/test/java">
		        <include name="**/sample/*.java"/>
		    </source>
		</apt>
        <!-- copy handlers descriptor file -->
        <copy todir="${build.classes.home}">
            <fileset dir="${basedir}/src/test/etc">
                <include name="**/*.xml"/>
            </fileset>
        </copy>
    </target>

    <target name="create-war">
        <war warfile="${build.war.home}/jaxws-${ant.project.name}.war" webxml="${basedir}/src/test/etc/web.xml">
            <webinf dir="${basedir}/src/test/etc" includes="sun-jaxws.xml"/>
            <zipfileset
                    dir="${basedir}/src/test/etc"
                    includes="*.wsdl, *.xsd"
                    prefix="WEB-INF/wsdl"/>
            <classes dir="${build.classes.home}"/>
        </war>
    </target>

    <target name="server" depends="setup">

        <antcall target="build-server-java"/>
        <antcall target="create-war"/>
        <antcall target="deploy"/>

</target>

</project>
