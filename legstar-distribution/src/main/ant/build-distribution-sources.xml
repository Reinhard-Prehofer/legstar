<!-- =================================================================================
     This script creates a single jar file with all LegStar sources.
 -->
<project basedir="../../.." default="buildDistributionSources" name="build-distribution-sources">

	<!-- ===========================================================  -->
	<!-- Setup environment
	  -->
	<target name="init">
		
		<!-- Temporary build location  -->
	 	<property name="temp.dir" value="${basedir}/target/work" />
        
		<!-- Sources jar files relative location  -->
	 	<property name="srce.loc" value="target" />
		<!-- Distribution file relative location  -->
	 	<property name="dist.loc" value="src/site/resources/binaries" />
		<!-- Distribution file absolute location  -->
	 	<property name="dist.dir" value="${basedir}/${dist.loc}" />

		<!-- LegStar sources distribution properties  -->
	 	<property name="legstar.loc" value="legstar-distribution" />
	 	<property name="legstar.fol" value="${legstar.loc}-${version}-sources" />
	 	<property name="legstar.jar" value="${srce.loc}/${legstar.fol}.jar" />
		
	</target>

	<!-- ===========================================================  -->
	<!-- Build the main sources distribution
	  -->
	<target name="buildDistributionSources" depends="init">
		
		<delete dir="${temp.dir}" includeEmptyDirs="true" quiet="true"/>
		<mkdir dir="${temp.dir}"/> 
		
		<!-- Unzip all source jars toporary folder  -->
		<unzip dest="${temp.dir}">
            <fileset dir="${basedir}/..">
                <include name="**/*-${version}-sources.jar"/>
                <exclude name="**/*-cases-${version}-sources.jar"/>
                <exclude name="**/legstar-distribution-${version}-sources.jar"/>
            </fileset>
        </unzip>

		<!-- Create legstar source distribution  -->
		<delete file="${legstar.jar}" quiet="true"/>
		<jar destfile="${legstar.jar}"
		       basedir="${temp.dir}"
			   includes="**"
		/>		

		<!-- Copy the distribution into the legstar central location  -->
		<copy todir="${dist.dir}" file="${legstar.jar}"/>
		
		<!-- Cleanup  -->
		<delete dir="${temp.dir}" includeEmptyDirs="true" quiet="true"/>

	</target>
	
</project>
