# Makefile for Schema Generator
# -----------------------------
# GNU C compiler/linker
CC       = cc
LINK     = cc
SRCDIR   = c/
INCDIR   = include/
BINDIR   = bin/
SOCFLAGS = -c -fPIC -O0 -Wall 
SOLFLAGS = -shared -lc 

all : PARSTSTS libCOB2XSDJNIWrapper.so libCOBDDANPJNIWrapper.so clean

libRegex2Picture.so :	RGX2PICP.o
	${LINK} ${SOLFLAGS} -o ${BINDIR}libRegex2Picture.so RGX2PICP.o

RGX2PICP.o :	${SRCDIR}RGX2PICP.c
	${CC} ${SOCFLAGS} ${SRCDIR}RGX2PICP.c -I${INCDIR}

libDDXSDProduce.so:	XSDDDPRL.o libRegex2Picture.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libDDXSDProduce.so XSDDDPRL.o

XSDDDPRL.o:	$(SRCDIR)XSDDDPRL.c $(INCDIR)XSDDDPRM.h $(INCDIR)XSDDDPRS.h $(INCDIR)COBDDPAS.h $(INCDIR)RGX2PICM.h $(INCDIR)RGX2PICS.h
	$(CC) ${SOCFLAGS} $(SRCDIR)XSDDDPRL.c -I$(INCDIR) 

libDDASNProduce.so:	ASNDDPRL.o libRegex2Picture.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libDDASNProduce.so ASNDDPRL.o

ASNDDPRL.o:	$(SRCDIR)ASNDDPRL.c $(INCDIR)ASNDDPRM.h $(INCDIR)ASNDDPRS.h $(INCDIR)COBDDPAS.h $(INCDIR)RGX2PICM.h $(INCDIR)RGX2PICS.h
	$(CC) ${SOCFLAGS} $(SRCDIR)ASNDDPRL.c -I$(INCDIR) 

libCOBDDAnalyze.so:	COBDDANP.o
	${LINK} ${SOLFLAGS} -o $(BINDIR)libCOBDDAnalyze.so COBDDANP.o

COBDDANP.o:	$(SRCDIR)COBDDANP.c $(INCDIR)COBDDANM.h $(INCDIR)COBDDANS.h $(INCDIR)COBDDPAS.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COBDDANP.c -I$(INCDIR)

libCOBDDParse.so:	COBDDPAL.o libCOBDDAnalyze.so
	${LINK} ${SOLFLAGS}-lm -o $(BINDIR)libCOBDDParse.so COBDDPAL.o

COBDDPAL.o:	$(SRCDIR)COBDDPAL.c $(INCDIR)COBDDPAM.h $(INCDIR)COBDDPAS.h $(INCDIR)COBDDANM.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COBDDPAL.c -I$(INCDIR)

libCOB2XSD.so:	COB2XSD.o libCOBDDParse.so libDDASNProduce.so libDDXSDProduce.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libCOB2XSD.so COB2XSD.o

COB2XSD.o:	$(SRCDIR)COB2XSD.c $(INCDIR)COB2XSDM.h $(INCDIR)COBDDPAS.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COB2XSD.c -I$(INCDIR)

PARSTSTS:	PARSTSTS.o libCOB2XSD.so
	${LINK} -o $(BINDIR)PARSTSTS PARSTSTS.o -lCOB2XSD -lDDXSDProduce -lCOBDDParse -lCOBDDAnalyze -lRegex2Picture -L$(BINDIR)

PARSTSTS.o:	$(SRCDIR)PARSTSTS.c $(INCDIR)COBDDPAS.h $(INCDIR)XSDDDPRS.h $(INCDIR)ASNDDPRS.h $(INCDIR)COB2XSDM.h 
	$(CC) -c $(SRCDIR)PARSTSTS.c -I$(INCDIR)

libCOB2XSDJNIWrapper.so:	COB2XSDJNIWrapper.o
	$(LINK) ${SOLFLAGS} -o $(BINDIR)libCOB2XSDJNIWrapper.so com_legstar_schemagen_COB2XSDJNIWrapper.o com_legstar_schemagen_UTILJNIWrapper.o  -lCOB2XSD -lDDXSDProduce -lCOBDDParse -lCOBDDAnalyze -lRegex2Picture -L$(BINDIR)
	
COB2XSDJNIWrapper.o:	$(SRCDIR)com_legstar_schemagen_COB2XSDJNIWrapper.c $(SRCDIR)com_legstar_schemagen_UTILJNIWrapper.c $(INCDIR)com_legstar_schemagen_COB2XSDJNIWrapper.h 
	$(CC) $(SOCFLAGS) $(SRCDIR)com_legstar_schemagen_COB2XSDJNIWrapper.c $(SRCDIR)com_legstar_schemagen_UTILJNIWrapper.c -I$(INCDIR)
	
libCOBDDANPJNIWrapper.so:	COBDDANPJNIWrapper.o
	$(LINK) ${SOLFLAGS} -o $(BINDIR)libCOBDDANPJNIWrapper.so com_legstar_schemagen_COBDDANPJNIWrapper.o com_legstar_schemagen_UTILJNIWrapper.o
	
COBDDANPJNIWrapper.o:	$(SRCDIR)com_legstar_schemagen_COBDDANPJNIWrapper.c $(SRCDIR)com_legstar_schemagen_UTILJNIWrapper.c $(INCDIR)com_legstar_schemagen_COBDDANPJNIWrapper.h 
	$(CC) $(SOCFLAGS) $(SRCDIR)com_legstar_schemagen_COBDDANPJNIWrapper.c $(SRCDIR)com_legstar_schemagen_UTILJNIWrapper.c -I$(INCDIR)
	
clean :
	rm *.o
