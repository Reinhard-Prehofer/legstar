# Makefile for Schema Generator
# -----------------------------
# GNU C compiler/linker
CC       = cc
LINK     = cc
SRCDIR   = c/
INCDIR   = include/
BINDIR   = bin/
TMPDIR   = temp/
SOCFLAGS = -c -fPIC -O0 -Wall 
SOLFLAGS = -shared -lc 

all : PARSTSTS clean

libRegex2Picture.so :	RGX2PICP.o
	${LINK} ${SOLFLAGS} -o ${BINDIR}libRegex2Picture.so $(TMPDIR)RGX2PICP.o

RGX2PICP.o :	${SRCDIR}RGX2PICP.c
	${CC} ${SOCFLAGS} ${SRCDIR}RGX2PICP.c -I${INCDIR} -o $(TMPDIR)RGX2PICP.o

libDDXSDProduce.so:	XSDDDPRL.o libRegex2Picture.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libDDXSDProduce.so $(TMPDIR)XSDDDPRL.o

XSDDDPRL.o:	$(SRCDIR)XSDDDPRL.c $(INCDIR)XSDDDPRM.h $(INCDIR)XSDDDPRS.h $(INCDIR)COBDDPAS.h $(INCDIR)RGX2PICM.h $(INCDIR)RGX2PICS.h
	$(CC) ${SOCFLAGS} $(SRCDIR)XSDDDPRL.c -I$(INCDIR) -o $(TMPDIR)XSDDDPRL.o

libDDASNProduce.so:	ASNDDPRL.o libRegex2Picture.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libDDASNProduce.so $(TMPDIR)ASNDDPRL.o

ASNDDPRL.o:	$(SRCDIR)ASNDDPRL.c $(INCDIR)ASNDDPRM.h $(INCDIR)ASNDDPRS.h $(INCDIR)COBDDPAS.h $(INCDIR)RGX2PICM.h $(INCDIR)RGX2PICS.h
	$(CC) ${SOCFLAGS} $(SRCDIR)ASNDDPRL.c -I$(INCDIR) -o $(TMPDIR)ASNDDPRL.o

libCOBDDAnalyze.so:	COBDDANP.o
	${LINK} ${SOLFLAGS} -o $(BINDIR)libCOBDDAnalyze.so $(TMPDIR)COBDDANP.o

COBDDANP.o:	$(SRCDIR)COBDDANP.c $(INCDIR)COBDDANM.h $(INCDIR)COBDDANS.h $(INCDIR)COBDDPAS.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COBDDANP.c -I$(INCDIR) -o $(TMPDIR)COBDDANP.o

libCOBDDParse.so:	COBDDPAL.o libCOBDDAnalyze.so
	${LINK} ${SOLFLAGS}-lm -o $(BINDIR)libCOBDDParse.so $(TMPDIR)COBDDPAL.o

COBDDPAL.o:	$(SRCDIR)COBDDPAL.c $(INCDIR)COBDDPAM.h $(INCDIR)COBDDPAS.h $(INCDIR)COBDDANM.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COBDDPAL.c -I$(INCDIR) -o $(TMPDIR)COBDDPAL.o

libCOB2XSD.so:	COB2XSD.o libCOBDDParse.so libDDASNProduce.so libDDXSDProduce.so
	${LINK} ${SOLFLAGS} -o $(BINDIR)libCOB2XSD.so $(TMPDIR)COB2XSD.o

COB2XSD.o:	$(SRCDIR)COB2XSD.c $(INCDIR)COB2XSDM.h $(INCDIR)COBDDPAS.h 
	$(CC) ${SOCFLAGS} $(SRCDIR)COB2XSD.c -I$(INCDIR) -o $(TMPDIR)COB2XSD.o

PARSTSTS:	PARSTSTS.o libCOB2XSD.so
	${LINK} -o $(BINDIR)PARSTSTS $(TMPDIR)PARSTSTS.o -lCOB2XSD -lDDXSDProduce -lCOBDDParse -lCOBDDAnalyze -lRegex2Picture -L$(BINDIR)

PARSTSTS.o:	$(SRCDIR)PARSTSTS.c $(INCDIR)COBDDPAS.h $(INCDIR)XSDDDPRS.h $(INCDIR)ASNDDPRS.h $(INCDIR)COB2XSDM.h
	$(CC) -c $(SRCDIR)PARSTSTS.c -I$(INCDIR) -o $(TMPDIR)PARSTSTS.o

clean :
	rm $(TMPDIR)*.o
