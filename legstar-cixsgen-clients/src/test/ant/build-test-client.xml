<?xml version="1.0" encoding="UTF-8"?>
<!-- =================================================================================
    This script generates Web Service clients for each of the Web Services
    generated in cixsgen.
 -->
<project basedir="../../.." default="generateAllJAXWSClients" name="build">

	<!-- Ant-Contrib tasks. Needed for "foreach ", regex, switch, ...
	     (ant-contrib.jar must be in ant classpath) -->
    <taskdef resource="net/sf/antcontrib/antcontrib.properties">
    	<classpath>
		    <pathelement location="C:\Program Files\Apache\antcontrib\ant-contrib-1.0b2-bin\ant-contrib\lib\ant-contrib.jar"/>
    	</classpath>
    </taskdef>

	<property name="maven.repo" value="C:\Documents and Settings\Fady\.m2\repository"/>
	<path id="jaxws.classpath">
		<pathelement location="${maven.repo}\javax\activation\activation\1.1\activation-1.1.jar"/>
		<pathelement location="${maven.repo}\javax\xml\bind\jaxb-api\2.1\jaxb-api-2.1.jar"/>
		<pathelement location="${maven.repo}\javax\xml\ws\jaxws-api\2.1\jaxws-api-2.1.jar"/>
		<pathelement location="${maven.repo}\javax\jws\jsr181-api\1.0-MR1\jsr181-api-1.0-MR1.jar"/>
		<pathelement location="${maven.repo}\javax\xml\bind\jsr173_api\1.0\jsr173_api-1.0.jar"/>
		<pathelement location="${maven.repo}\javax\xml\stream\stax-api\1.0\stax-api-1.0.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\ws\jaxws-rt\2.1-SNAPSHOT\jaxws-rt-2.1-SNAPSHOT.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\ws\jaxws-tools\2.1-SNAPSHOT\jaxws-tools-2.1-SNAPSHOT.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\bind\jaxb-impl\2.1.1\jaxb-impl-2.1.1.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\bind\jaxb-xjc\2.1.1\jaxb-xjc-2.1.1.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\stream\sjsxp\1.0\sjsxp-1.0.jar"/>
		<pathelement location="${maven.repo}\com\sun\xml\stream\buffer\streambuffer\0.3\streambuffer-0.3.jar"/>
		<pathelement location="${maven.repo}\org\jvnet\staxex\stax-ex\1.0-SNAPSHOT\stax-ex-1.0-SNAPSHOT.jar"/>
    </path>

    <taskdef name="wsimport" classname="com.sun.tools.ws.ant.WsImport">
		<classpath refid="jaxws.classpath"/>
	</taskdef>

	<!-- Generate JAXWS client artifacts for each CIXWS generated Web Service.        -->
	<target name="generateAllJAXWSClients">
		<foreach target="generateJAXWSClient" param="cixs.dir">
			<path>
				<dirset dir="${basedir}/../legstar-cixsgen/src/test/gen-ant" includes="*"/>
			</path>
		</foreach>
	</target>

	<target name="generateJAXWSClient" description="Create JAXWS Web Service clients">
		
		 <basename property="service-name" file="${cixs.dir}"  suffix=".xsd"/>
		 <echo>Processing ${service-name}</echo>
		 <wsimport
		 	debug="true"
		 	verbose="true"
		 	keep="true"
		 	destdir="src/test/java"
		 	wsdl="http://localhost:8080/cixs-${service-name}/${service-name}?wsdl">
		 </wsimport>
		
  	</target>
  
</project>